<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hardcore Minesweeper</title>

  <meta name="theme-color" content="#0d1033" />
  <link rel="manifest" href="manifest.json?v=9" />
  <link rel="stylesheet" href="style.css?v=9" />

  <!-- iOS PWA (optional) -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
</head>
<body>

  <div id="topRight">
    <button id="settingsBtn" class="mini-btn" type="button" title="Settings" aria-label="Settings">âš™ï¸</button>
    <button id="langBtn" class="mini-btn" type="button" onclick="toggleLanguage()">RU</button>

    <div id="musicBox">
      <span class="musicLabel">ğŸµ</span>
      <input id="musicVolume" type="range" min="0" max="100" value="30" />
    </div>
  </div>

  <h1 id="title">ğŸ’£ Minesweeper: Hardcore</h1>

  <div id="controls">
    <button id="btnHard" onclick="playClickStart(); startGame('hard')">ğŸ”´ HARD</button>
    <button id="btnInsane" onclick="playClickStart(); startGame('insane')">â˜ ï¸ INSANE</button>
    <button id="btnDaily" onclick="playClickStart(); startGame('daily')">ğŸ“… DAILY</button>

    <button id="giveUpBtn" onclick="giveUpClick()">I GIVE UP</button>

    <div class="miniControlsRow">
      <button id="musicToggleBtn" title="Music" onclick="toggleMusic()">ğŸµ</button>

      <button id="restartBtn" class="iconBtn" title="Restart level" onclick="restartLevel()" aria-label="Restart level">
        <svg class="restartIcon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M21 12a9 9 0 1 1-3.1-6.8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M21 4v6h-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
  </div>

  <div id="info">
    â± <span id="time">0:00</span> |
    ğŸš© <span id="flags">0</span> |
    ğŸ’£ <span id="minesLeft">0</span> |
    â­ <span id="score">0</span> |
    ğŸ† <span id="record">0</span> |
    ğŸ”¥ <span id="streak">0</span>
  </div>

  <div id="board"></div>

  <!-- Settings panel -->
  <div id="settingsOverlay" class="overlay hidden" aria-hidden="true"></div>
  <aside id="settingsPanel" class="panel hidden" aria-label="Settings panel">
    <div class="panelHeader">
      <div class="panelTitle" id="settingsTitle">Settings</div>
      <button id="settingsClose" class="mini-btn" type="button" aria-label="Close settings">âœ–</button>
    </div>

    <div class="panelBody">
      <div class="row">
        <div class="rowLabel" id="lblMusicVol">Music volume</div>
        <input id="musicVolume2" type="range" min="0" max="100" value="30" />
      </div>

      <div class="row">
        <div class="rowLabel" id="lblSfxVol">SFX volume</div>
        <input id="sfxVolume" type="range" min="0" max="100" value="60" />
      </div>

      <label class="toggle">
        <input id="toggleVibrate" type="checkbox" />
        <span id="lblVibrate">Vibration</span>
      </label>

      <label class="toggle">
        <input id="toggleSnark" type="checkbox" />
        <span id="lblSnark">Snarky phrases</span>
      </label>

      <div class="divider"></div>

      <div class="panelTitleSmall" id="historyTitle">Last games</div>
      <div id="historyList" class="historyList"></div>

      <div class="divider"></div>

      <button id="resetStatsBtn" class="dangerBtn" type="button">Reset stats</button>
    </div>
  </aside>

  <!-- Result modal -->
  <div id="modalOverlay" class="overlay hidden" aria-hidden="true"></div>
  <div id="resultModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modalHeader">
      <div id="modalTitle" class="modalTitle">Result</div>
      <div id="modalSubtitle" class="modalSubtitle"></div>
    </div>

    <div class="modalBody">
      <div id="modalPhrase" class="modalPhrase"></div>

      <div class="statsGrid">
        <div class="stat">
          <div class="statLabel" id="mScoreLabel">Score</div>
          <div class="statValue" id="mScore">0</div>
        </div>
        <div class="stat">
          <div class="statLabel" id="mTimeLabel">Time</div>
          <div class="statValue" id="mTime">0:00</div>
        </div>
        <div class="stat">
          <div class="statLabel" id="mStreakLabel">Streak</div>
          <div class="statValue" id="mStreak">0</div>
        </div>
      </div>
    </div>

    <div class="modalFooter">
      <button id="modalRetry" type="button">Retry</button>
      <button id="modalMenu" type="button">Menu</button>
    </div>
  </div>

  <!-- Confetti layer -->
  <div id="confettiLayer" aria-hidden="true"></div>

  <audio id="clickSound" src="audio/click.mp3" preload="auto"></audio>
  <audio id="boomSound"  src="audio/boom.mp3"  preload="auto"></audio>
  <audio id="winSound"   src="audio/win.mp3"   preload="auto"></audio>
  <audio id="bgMusic" src="audio/bg.mp3" loop preload="auto"></audio>

  <script src="script.js?v=9"></script>

  <script>
    // PWA offline
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(()=>{});
      });
    }
  </script>
</body>
</html>


